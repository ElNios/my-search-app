<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>虛擬瀏覽器搜尋</title>
<style>
body { font-family: Arial; margin: 20px; }
input { width: 300px; padding: 6px; }
button { padding: 6px 12px; margin-left: 5px; }
#results div { margin: 8px 0; }
#results a { color: blue; text-decoration: underline; cursor: pointer; }
iframe { border: 1px solid #ccc; margin-top: 10px; width: 100%; height: 500px; }
</style>
</head>
<body>
<h2>🔍 虛擬瀏覽器搜尋</h2>
<input id="query" placeholder="輸入搜尋關鍵字">
<button onclick="search()">搜尋</button>

<div id="results"></div>
<iframe id="browser"></iframe>

<script>
const BASE_URL = "https://my-search-app-jxel.onrender.com"; // Render URL

async function search() {
  const q = document.getElementById("query").value.trim();
  if (!q) return alert("請輸入關鍵字");

  try {
    const res = await fetch(`${BASE_URL}/search?q=${encodeURIComponent(q)}`);
    const data = await res.json();

    let html = "";
    if (data.items && data.items.length > 0) {
      data.items.forEach(item => {
        html += `<div><a href="#" onclick="openSite('${item.link}')">${item.title}</a></div>`;
      });
    } else {
      html = "<p>❌ 找不到結果</p>";
    }
    document.getElementById("results").innerHTML = html;
  } catch (err) {
    console.error(err);
    document.getElementById("results").innerHTML = "<p>❌ 搜尋失敗</p>";
  }
}

function openSite(url) {
  document.getElementById("browser").src = `${BASE_URL}/proxy?url=` + encodeURIComponent(url);
}
</script>
</body>
</html>
